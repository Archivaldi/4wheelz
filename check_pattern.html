<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
    <div id="test_1_div">
        <label for="test_1">Please type the following text: "<span id="text_to_type_1">I'm here to create a new account</span>"</label>
        <br>
        <input type="text" id="test_1">
    </div>
    <button onclick=check_pattern()>Submit</button>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://www.typingdna.com/scripts/typingdna.js"></script>
    <script>
        var tdna = new TypingDNA();
        const check_pattern = () => {
            tdna.stop();
            if ($("#test_1").val() === $("#text_to_type_1").text()){
                var typingPattern = tdna.getTypingPattern({type:1, text: $(`#text_to_type_1`).text()});
                $.ajax({
                    url: "/check_pattern",
                    method: "POST",
                    data: {typingPattern}
                }).then(r => {
                    if (r.message === "Success!"){
                        console.log(r.message)
                    } else {
                        alert("Something is wrong. Please try again");
                        $("#test_1").val("");
                        tdna.start();
                    }
                })
            } else {
                alert("Tetxs don't match. Please try again");
                $("#test_1").val("");
                tdna.start();
            }
        }
    </script>
</body>
</html>